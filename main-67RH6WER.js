import{a as te,b as ae,c as I,d as O,f as se,g as R}from"./chunk-CDMILCXF.js";import{a as H}from"./chunk-ZYWFXMK7.js";import{a as ne,b as ie,c as oe,d as re}from"./chunk-4VDU63PD.js";import{d as T,e as F,g as L,o as y}from"./chunk-RTCBCNOZ.js";import{$ as k,$a as U,Aa as P,Fa as b,Ka as g,O as B,Oa as d,Rb as w,S as q,Sb as Y,Tb as ee,Va as s,Vb as _,Wa as o,Xa as r,Ya as f,Za as V,_ as v,_a as $,ab as J,cb as W,db as u,eb as Z,fa as z,fb as c,ga as G,gb as K,hb as Q,mb as C,ob as l,qb as h,va as a,zb as X}from"./chunk-VD7T3VHC.js";function de(t,i){if(t&1&&(o(0,"label",7),l(1),r()),t&2){let e=c();a(),h(" ",e.label," ")}}function ge(t,i){if(t&1&&(v(),o(0,"svg",8),f(1,"path",9)(2,"circle",10),r()),t&2){let e=c();C("text-blue-500",e.isFocused)("text-gray-400",!e.isFocused)}}function fe(t,i){if(t&1&&(v(),o(0,"svg",8),f(1,"rect",11)(2,"path",12),r()),t&2){let e=c();C("text-blue-500",e.isFocused)("text-gray-400",!e.isFocused)}}function he(t,i){if(t&1&&(v(),o(0,"svg",8),f(1,"rect",13)(2,"path",14),r()),t&2){let e=c();C("text-blue-500",e.isFocused)("text-gray-400",!e.isFocused)}}var x=class t{icon="user";type="text";placeholder="";label="";value="";valueChange=new P;isFocused=!1;onFocus(){this.isFocused=!0}onBlur(){this.isFocused=!1}onInputChange(i){this.valueChange.emit(i.target.value)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=g({type:t,selectors:[["app-input-field"]],inputs:{icon:"icon",type:"type",placeholder:"placeholder",label:"label",value:"value"},outputs:{valueChange:"valueChange"},decls:9,vars:12,consts:[[1,"mb-6"],["class","block text-gray-800 font-medium mb-2 text-left",4,"ngIf"],[1,"relative"],[1,"absolute","left-4","top-1/2","transform","-translate-y-1/2"],[3,"ngSwitch"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","class","icon-transition",3,"text-blue-500","text-gray-400",4,"ngSwitchCase"],[1,"input-field",3,"input","focus","blur","type","placeholder","value"],[1,"block","text-gray-800","font-medium","mb-2","text-left"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"icon-transition"],["d","M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"],["cx","12","cy","7","r","4"],["width","20","height","16","x","2","y","4","rx","2"],["d","m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"],["width","18","height","11","x","3","y","11","rx","2","ry","2"],["d","M7 11V7a5 5 0 0 1 10 0v4"]],template:function(e,n){e&1&&(o(0,"div",0),d(1,de,2,1,"label",1),o(2,"div",2)(3,"div",3),U(4,4),d(5,ge,3,4,"svg",5)(6,fe,3,4,"svg",5)(7,he,3,4,"svg",5),J(),r(),o(8,"input",6),u("input",function(p){return n.onInputChange(p)})("focus",function(){return n.onFocus()})("blur",function(){return n.onBlur()}),r()()()),e&2&&(a(),s("ngIf",n.label),a(3),s("ngSwitch",n.icon),a(),s("ngSwitchCase","user"),a(),s("ngSwitchCase","mail"),a(),s("ngSwitchCase","lock"),a(),C("input-focused",n.isFocused)("input-default",!n.isFocused),s("type",n.type)("placeholder",n.placeholder)("value",n.value))},dependencies:[_,w,Y,ee,y],styles:[".icon-transition[_ngcontent-%COMP%]{transition:all .3s ease}.input-field[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem .75rem 3rem;border-radius:.5rem;border-width:2px;transition:all .3s ease;outline:none;background-color:#f9fafb}.input-field[_ngcontent-%COMP%]:hover{border-color:#d1d5db}.input-default[_ngcontent-%COMP%]{border-color:#e5e7eb}.input-focused[_ngcontent-%COMP%]{border-color:#60a5fa;background-color:#fff;box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}"]})};var ve=["*"],S=class t{type="button";clicked=new P;isHovered=!1;handleClick(){this.clicked.emit()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=g({type:t,selectors:[["app-button"]],inputs:{type:"type"},outputs:{clicked:"clicked"},ngContentSelectors:ve,decls:2,vars:3,consts:[[1,"custom-button",3,"click","mouseenter","mouseleave","type"]],template:function(e,n){e&1&&(K(),V(0,"button",0),Z("click",function(){return n.handleClick()})("mouseenter",function(){return n.isHovered=!0})("mouseleave",function(){return n.isHovered=!1}),Q(1),$()),e&2&&(C("button-hovered",n.isHovered),W("type",n.type))},dependencies:[_],styles:[".custom-button[_ngcontent-%COMP%]{width:100%;padding:1rem;border-radius:9999px;font-weight:600;transition:all .3s ease;transform:scale(1);background-color:#3b82f6;color:#fff;border:none;cursor:pointer}.custom-button[_ngcontent-%COMP%]:hover{background-color:#2563eb;box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}.button-hovered[_ngcontent-%COMP%]{transform:scale(1.05)}"]})};var E=class t{constructor(i){this.http=i}apiEntry=H.apiEntry;apiUrl=H.apiUrl;getAuthHeaders(){let i=localStorage.getItem("access_token");return console.log("Using token:",i?.substring(0,20)+"..."),new ne({Authorization:`Bearer ${i}`,"Content-Type":"application/json"})}login(i){return this.http.post(`${this.apiEntry}/auth/admin/login`,i)}register(i){return this.http.post(`${this.apiEntry}/auth/admin/register`,i)}storeToken(i){localStorage.setItem("access_token",i)}getToken(){return localStorage.getItem("access_token")}static \u0275fac=function(e){return new(e||t)(q(ie))};static \u0275prov=B({token:t,factory:t.\u0275fac,providedIn:"root"})};function be(t,i){if(t&1&&(o(0,"div",23),l(1),r()),t&2){let e=c();a(),h(" ",e.signupError," ")}}function we(t,i){if(t&1&&(o(0,"div",23),l(1),r()),t&2){let e=c();a(),h(" ",e.signupError," ")}}function ye(t,i){if(t&1&&(o(0,"div",23),l(1),r()),t&2){let e=c();a(),h(" ",e.signupError," ")}}function xe(t,i){if(t&1&&(o(0,"div",23),l(1),r()),t&2){let e=c();a(),h(" ",e.signupError," ")}}function Se(t,i){t&1&&(o(0,"div",23),l(1," Passwords do not match "),r())}function Ee(t,i){if(t&1&&(o(0,"div",23),l(1),r()),t&2){let e=c();a(),h(" ",e.resultError," ")}}var N=class t{constructor(i,e){this.adminService=i;this.router=e}passwordsMatch=!0;showPasswordError=!1;name="";surname="";email="";password="";confirmPassword="";signupError="";resultError="";validationForm(){return this.name.trim()?this.surname.trim()?this.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.email)?this.password.trim()?this.password.length<6?(this.signupError="password must be at least 6 characters",!1):this.password!==this.confirmPassword?(this.signupError="password mismatch",this.passwordsMatch=!1,this.showPasswordError=!0,!1):(this.signupError="",this.passwordsMatch=!0,this.showPasswordError=!1,!0):(this.signupError="password is required",!1):(this.signupError="email format is invalid",!1):(this.signupError="email is required",!1):(this.signupError="surname is required",!1):(this.signupError="this field is required",!1)}onSignup(){if(!this.validationForm())return;let i={name:this.name,surname:this.surname,email:this.email,password:this.password};this.adminService.register(i).subscribe({next:e=>{console.log("Signup successful:",e),this.resultError="",this.router.navigate(["/login"])},error:e=>{console.error("Signup failed:",e);let n="Registration failed. Please try again.";e?.error&&(e.error.error?n=e.error.error:e.error.message?n=e.error.message:Array.isArray(e.error)&&e.error.length>0&&(n=e.error[0].defaultMessage||e.error[0].message||n)),e?.status===400||(e?.status===409?n="Email already registered":e?.status===0||e?.status===void 0?n="Unable to connect to server. Please check your connection.":e?.status>=500&&(n="Server error. Please try again later.")),this.resultError=n}})}static \u0275fac=function(e){return new(e||t)(b(E),b(I))};static \u0275cmp=g({type:t,selectors:[["app-signup"]],decls:33,vars:11,consts:[[1,"signup-container"],[1,"signup-card"],[1,"header-icon-wrapper"],[1,"header-icon"],["xmlns","http://www.w3.org/2000/svg","width","48","height","48","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"phone-icon"],["width","14","height","20","x","5","y","2","rx","2","ry","2"],["d","M12 18h.01"],[1,"header-text"],[1,"title"],[1,"subtitle"],[3,"ngSubmit"],["icon","user","type","text","placeholder","Enter your name","label","name",3,"valueChange","value"],["class","error-message",4,"ngIf"],["icon","user","type","text","placeholder","Enter your surname","label","surname",3,"valueChange","value"],["icon","mail","type","email","placeholder","Enter your email address","label","Email",3,"valueChange","value"],["icon","lock","type","password","placeholder","Enter your password","label","Password",3,"valueChange","value"],["icon","lock","type","password","placeholder","Confirm your password","label","Confirm Password",3,"valueChange","value"],[1,"form-group"],[1,"submit-button-wrapper"],["type","submit"],[1,"footer-text"],[1,"footer-message"],["href","#","routerLink","/login",1,"login-link"],[1,"error-message"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),v(),o(4,"svg",4),f(5,"rect",5)(6,"path",6),r()()(),k(),o(7,"div",7)(8,"h1",8),l(9,"Admin Portal Signup"),r(),o(10,"p",9),l(11,"Create your account to get started"),r()(),o(12,"form",10),u("ngSubmit",function(){return n.onSignup()}),o(13,"app-input-field",11),u("valueChange",function(p){return n.name=p}),r(),d(14,be,2,1,"div",12),o(15,"app-input-field",13),u("valueChange",function(p){return n.surname=p}),r(),d(16,we,2,1,"div",12),o(17,"app-input-field",14),u("valueChange",function(p){return n.email=p}),r(),d(18,ye,2,1,"div",12),o(19,"app-input-field",15),u("valueChange",function(p){return n.password=p}),r(),d(20,xe,2,1,"div",12),o(21,"app-input-field",16),u("valueChange",function(p){return n.confirmPassword=p}),r(),d(22,Se,2,0,"div",12),o(23,"div",17),d(24,Ee,2,1,"div",12),r(),o(25,"div",18)(26,"app-button",19),l(27," Sign Up "),r()(),o(28,"div",20)(29,"p",21),l(30," Already have an account? "),o(31,"a",22),l(32,"Log In"),r()()()()()()),e&2&&(a(13),s("value",n.name),a(),s("ngIf",n.signupError&&n.signupError.includes("field")),a(),s("value",n.surname),a(),s("ngIf",n.signupError&&n.signupError.includes("surname")),a(),s("value",n.email),a(),s("ngIf",n.signupError&&n.signupError.includes("email")),a(),s("value",n.password),a(),s("ngIf",n.signupError&&n.signupError.includes("password")),a(),s("value",n.confirmPassword),a(),s("ngIf",n.showPasswordError&&!n.passwordsMatch),a(2),s("ngIf",n.resultError))},dependencies:[_,w,x,S,R,O,y,L,T,F],styles:[".signup-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#fff;display:flex;align-items:center;justify-content:center;padding:1.5rem}.signup-card[_ngcontent-%COMP%]{width:100%;max-width:28rem}.error-message[_ngcontent-%COMP%]{color:#f44336;font-size:10px;margin-top:2px;font-weight:500}.header-icon-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:2rem}.header-icon[_ngcontent-%COMP%]{width:6rem;height:6rem;background-color:#dbeafe;border-radius:9999px;display:flex;align-items:center;justify-content:center}.phone-icon[_ngcontent-%COMP%]{color:#3b82f6}.header-text[_ngcontent-%COMP%]{text-align:center;margin-bottom:2.5rem}.title[_ngcontent-%COMP%]{font-size:1.875rem;font-weight:700;color:#111827;margin-bottom:.75rem}.subtitle[_ngcontent-%COMP%]{color:#6b7280;font-size:1rem}.submit-button-wrapper[_ngcontent-%COMP%]{margin-top:2rem}.footer-text[_ngcontent-%COMP%]{text-align:center;margin-top:1.5rem}.footer-message[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem}.login-link[_ngcontent-%COMP%]{color:#3b82f6;font-weight:600;text-decoration:none;transition:color .3s ease}.login-link[_ngcontent-%COMP%]:hover{color:#2563eb}"]})};function Me(t,i){if(t&1&&(o(0,"div",20),l(1),r()),t&2){let e=c();a(),h(" ",e.loginError," ")}}var D=class t{constructor(i,e){this.adminService=i;this.router=e}email="";password="";loginError="";onSignIn(){if(!this.email||!this.password){this.loginError="Email and password are required";return}let i={email:this.email,password:this.password};this.adminService.login(i).subscribe({next:e=>{this.adminService.storeToken(e.accessToken),localStorage.setItem("admin",JSON.stringify(e.admin)),console.log("\u2705 Login successful"),console.log(`token: ${e.accessToken}`),console.log(`admin: ${localStorage.getItem("admin")}`),this.router.navigate(["/dashboard"])},error:e=>{console.error("Login failed:",e),this.loginError="Login failed. Please check your credentials and try again.",console.log("\u274C login failed ",e);let n="Login failed";e?.error?.message?n=e.error.message:e?.message&&(n="A Service is unavailable. Try again later!"),this.loginError=n}})}static \u0275fac=function(e){return new(e||t)(b(E),b(I))};static \u0275cmp=g({type:t,selectors:[["app-login"]],decls:25,vars:3,consts:[[1,"signup-container"],[1,"signup-card"],[1,"header-icon-wrapper"],[1,"header-icon"],["xmlns","http://www.w3.org/2000/svg","width","48","height","48","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"phone-icon"],["width","14","height","20","x","5","y","2","rx","2","ry","2"],["d","M12 18h.01"],[1,"header-text"],[1,"title"],[1,"subtitle"],[3,"ngSubmit"],["icon","mail","type","text","placeholder","Enter your email","label","Email",3,"valueChange","value"],["icon","lock","type","password","placeholder","Enter your password","label","Password",3,"valueChange","value"],[1,"form-group"],["class","error-message",4,"ngIf"],[1,"submit-button-wrapper"],["type","submit"],[1,"footer-text"],[1,"footer-message"],["href","#","routerLink","/signup",1,"login-link"],[1,"error-message"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),v(),o(4,"svg",4),f(5,"rect",5)(6,"path",6),r()()(),k(),o(7,"div",7)(8,"h1",8),l(9,"Admin Portal Login"),r(),o(10,"p",9),l(11,"Welcome Back! Login to get started"),r()(),o(12,"form",10),u("ngSubmit",function(){return n.onSignIn()}),o(13,"app-input-field",11),u("valueChange",function(p){return n.email=p}),r(),o(14,"app-input-field",12),u("valueChange",function(p){return n.password=p}),r(),o(15,"div",13),d(16,Me,2,1,"div",14),r(),o(17,"div",15)(18,"app-button",16),l(19," Login "),r()(),o(20,"div",17)(21,"p",18),l(22," Don't have an Account? "),o(23,"a",19),l(24,"SignUp"),r()()()()()()),e&2&&(a(13),s("value",n.email),a(),s("value",n.password),a(2),s("ngIf",n.loginError))},dependencies:[_,w,x,S,R,O,y,L,T,F],styles:[".signup-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#fff;display:flex;align-items:center;justify-content:center;padding:1.5rem}.signup-card[_ngcontent-%COMP%]{width:100%;max-width:28rem}.header-icon-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:2rem}.header-icon[_ngcontent-%COMP%]{width:6rem;height:6rem;background-color:#dbeafe;border-radius:9999px;display:flex;align-items:center;justify-content:center}.error-message[_ngcontent-%COMP%]{color:#f44336;font-size:10px;margin-top:2px;font-weight:500}.phone-icon[_ngcontent-%COMP%]{color:#3b82f6}.header-text[_ngcontent-%COMP%]{text-align:center;margin-bottom:2.5rem}.title[_ngcontent-%COMP%]{font-size:1.875rem;font-weight:700;color:#111827;margin-bottom:.75rem}.subtitle[_ngcontent-%COMP%]{color:#6b7280;font-size:1rem}.submit-button-wrapper[_ngcontent-%COMP%]{margin-top:2rem}.footer-text[_ngcontent-%COMP%]{text-align:center;margin-top:1.5rem}.footer-message[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem}.login-link[_ngcontent-%COMP%]{color:#3b82f6;font-weight:600;text-decoration:none;transition:color .3s ease}.login-link[_ngcontent-%COMP%]:hover{color:#2563eb}"]})};var me=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:D},{path:"signup",component:N},{path:"",loadComponent:()=>import("./chunk-CND4HKMS.js").then(t=>t.Layout),children:[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",loadComponent:()=>import("./chunk-NWMQORMU.js").then(t=>t.Dashboard)},{path:"staff",loadComponent:()=>import("./chunk-AOJWB4GY.js").then(t=>t.StaffManagement)},{path:"attendance",loadComponent:()=>import("./chunk-NBUZFSFX.js").then(t=>t.AttendanceRecords)},{path:"reports",loadComponent:()=>import("./chunk-FYF4X3BZ.js").then(t=>t.Reports)},{path:"settings",loadComponent:()=>import("./chunk-TZOSEXTW.js").then(t=>t.Settings)}]},{path:"**",redirectTo:"login"}];var ue=(t,i)=>{let e=localStorage.getItem("access_token");if(t.url.includes("/auth/"))return i(t);if(e){let n=t.clone({setHeaders:{Authorization:`Bearer ${e}`}});return console.log("\u{1F510} Adding token to request:",t.url),i(n)}return console.warn("\u26A0\uFE0F No token found for request:",t.url),i(t)};var ce={providers:[z(),X({eventCoalescing:!0}),oe(re([ue])),se(me)]};var j=class t{title=G("attendflow");static \u0275fac=function(e){return new(e||t)};static \u0275cmp=g({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(e,n){e&1&&f(0,"router-outlet")},dependencies:[ae],encapsulation:2})};te(j,ce).catch(t=>console.error(t));
